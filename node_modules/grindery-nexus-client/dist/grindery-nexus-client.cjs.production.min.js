"use strict";function r(r){return r&&"object"==typeof r&&"default"in r?r.default:r}Object.defineProperty(exports,"__esModule",{value:!0});var e=r(require("axios")),t=r(require("jwt-decode"));function n(){n=function(){return r};var r={},e=Object.prototype,t=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(r,e,t){return Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),r[e]}try{u({},"")}catch(r){u=function(r,e,t){return r[e]=t}}function c(r,e,t,n){var o=Object.create((e&&e.prototype instanceof p?e:p).prototype),i=new q(n||[]);return o._invoke=function(r,e,t){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(t.method=o,t.arg=i;;){var a=t.delegate;if(a){var s=m(a,t);if(s){if(s===f)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===n)throw n="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n="executing";var u=h(r,e,t);if("normal"===u.type){if(n=t.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:t.done}}"throw"===u.type&&(n="completed",t.method="throw",t.arg=u.arg)}}}(r,t,i),o}function h(r,e,t){try{return{type:"normal",arg:r.call(e,t)}}catch(r){return{type:"throw",arg:r}}}r.wrap=c;var f={};function p(){}function l(){}function d(){}var w={};u(w,i,(function(){return this}));var k=Object.getPrototypeOf,v=k&&k(k(A([])));v&&v!==e&&t.call(v,i)&&(w=v);var y=d.prototype=p.prototype=Object.create(w);function x(r){["next","throw","return"].forEach((function(e){u(r,e,(function(r){return this._invoke(e,r)}))}))}function b(r,e){var n;this._invoke=function(o,i){function a(){return new e((function(n,a){!function n(o,i,a,s){var u=h(r[o],r,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==typeof f&&t.call(f,"__await")?e.resolve(f.__await).then((function(r){n("next",r,a,s)}),(function(r){n("throw",r,a,s)})):e.resolve(f).then((function(r){c.value=r,a(c)}),(function(r){return n("throw",r,a,s)}))}s(u.arg)}(o,i,n,a)}))}return n=n?n.then(a,a):a()}}function m(r,e){var t=r.iterator[e.method];if(void 0===t){if(e.delegate=null,"throw"===e.method){if(r.iterator.return&&(e.method="return",e.arg=void 0,m(r,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=h(t,r.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,f;var o=n.arg;return o?o.done?(e[r.resultName]=o.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function g(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function E(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function q(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(g,this),this.reset(!0)}function A(r){if(r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var n=-1,o=function e(){for(;++n<r.length;)if(t.call(r,n))return e.value=r[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:_}}function _(){return{value:void 0,done:!0}}return l.prototype=d,u(y,"constructor",d),u(d,"constructor",l),l.displayName=u(d,s,"GeneratorFunction"),r.isGeneratorFunction=function(r){var e="function"==typeof r&&r.constructor;return!!e&&(e===l||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,d):(r.__proto__=d,u(r,s,"GeneratorFunction")),r.prototype=Object.create(y),r},r.awrap=function(r){return{__await:r}},x(b.prototype),u(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(e,t,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,t,n,o),i);return r.isGeneratorFunction(t)?a:a.next().then((function(r){return r.done?r.value:a.next()}))},x(y),u(y,s,"Generator"),u(y,i,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),r.keys=function(r){var e=[];for(var t in r)e.push(t);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=A,q.prototype={constructor:q,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&t.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var r=this.tryEntries[0].completion;if("throw"===r.type)throw r.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t,n){return a.type="throw",a.arg=r,e.next=t,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=t.call(i,"catchLoc"),u=t.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(r,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&t.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===r||"continue"===r)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=r,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(r,e){if("throw"===r.type)throw r.arg;return"break"===r.type||"continue"===r.type?this.next=r.arg:"return"===r.type?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):"normal"===r.type&&e&&(this.next=e),f},finish:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===r)return this.complete(t.completion,t.afterLoc),E(t),f}},catch:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===r){var n=t.completion;if("throw"===n.type){var o=n.arg;E(t)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(r,e,t){return this.delegate={iterator:A(r),resultName:e,nextLoc:t},"next"===this.method&&(this.arg=void 0),f}},r}function o(r,e,t,n,o,i,a){try{var s=r[i](a),u=s.value}catch(r){return void t(r)}s.done?e(u):Promise.resolve(u).then(n,o)}function i(r){return function(){var e=this,t=arguments;return new Promise((function(n,i){var a=r.apply(e,t);function s(r){o(a,n,i,s,u,"next",r)}function u(r){o(a,n,i,s,u,"throw",r)}s(void 0)}))}}function a(){return(a=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}).apply(this,arguments)}var s=function(){var r=i(n().mark((function r(t,o,i){var a,s,u;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a={},i&&(a.Authorization="Bearer "+i),r.prev=2,r.next=5,e.post("https://orchestrator.grindery.org",{jsonrpc:"2.0",method:t,id:new Date,params:o},{headers:a});case 5:if(!(s=r.sent)||!s.data||void 0===s.data.result){r.next=10;break}return r.abrupt("return",s.data.result);case 10:throw new Error("Unknown error");case 11:r.next=22;break;case 13:if(r.prev=13,r.t0=r.catch(2),!e.isAxiosError(r.t0)){r.next=21;break}if(!((u=r.t0).response&&u.response.data&&u.response.data.error)){r.next=19;break}throw new Error(u.response.data.error.message);case 19:r.next=22;break;case 21:throw new Error(r.t0.message);case 22:case"end":return r.stop()}}),r,null,[[2,13]])})));return function(e,t,n){return r.apply(this,arguments)}}(),u=function(){var r=i(n().mark((function r(t,o,i,a){var s,u,c;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s={},a&&(s.Authorization="Bearer "+a),r.prev=2,r.next=5,e.request({method:t,url:"https://orchestrator.grindery.org"+o,data:i,headers:s});case 5:if(!((u=r.sent)&&u.data&&u.data.result)){r.next=10;break}return r.abrupt("return",u.data.result);case 10:throw new Error("Unknown error");case 11:r.next=22;break;case 13:if(r.prev=13,r.t0=r.catch(2),!e.isAxiosError(r.t0)){r.next=21;break}if(!((c=r.t0).response&&c.response.data&&c.response.data.error)){r.next=19;break}throw new Error(c.response.data.error.message);case 19:r.next=22;break;case 21:throw new Error(r.t0.message);case 22:case"end":return r.stop()}}),r,null,[[2,13]])})));return function(e,t,n,o){return r.apply(this,arguments)}}(),c=function(r,e){var t,n;return a({},r,{triggers:(null==(t=r.triggers)?void 0:t.map((function(t){var n,o,i,s,u;return a({},t,{operation:a({},t.operation,{inputFields:[].concat("blockchain:event"===(null==(n=t.operation)?void 0:n.type)&&((null==(o=t.operation)?void 0:o.inputFields)||[]).filter((function(r){return"_grinderyChain"===r.key})).length<1||"evmWallet"===r.key?[{key:"_grinderyChain",type:"string",label:"Blockchain",placeholder:"Select a blockchain",required:!0,choices:e.map((function(r){return{value:r.value,label:r.label,sample:r.value,icon:r.icon||void 0}}))}]:[],"blockchain:event"===(null==(i=t.operation)?void 0:i.type)&&((null==(s=t.operation)?void 0:s.inputFields)||[]).filter((function(r){return"_grinderyContractAddress"===r.key})).length<1?[{key:"_grinderyContractAddress",type:"string",label:"Contract address",placeholder:"Enter contract address",required:!0}]:[],((null==(u=t.operation)?void 0:u.inputFields)||[]).filter((function(e){return"evmWallet"===r.key&&"_grinderyChain"!==e.key||"evmWallet"!==r.key})))})})})))||[],actions:(null==(n=r.actions)?void 0:n.map((function(t){var n,o,i,s,u;return a({},t,{operation:a({},t.operation,{inputFields:[].concat("blockchain:call"===(null==(n=t.operation)?void 0:n.type)&&((null==(o=t.operation)?void 0:o.inputFields)||[]).filter((function(r){return"_grinderyChain"===r.key})).length<1||"evmWallet"===r.key?[{key:"_grinderyChain",type:"string",label:"Blockchain",placeholder:"Select a blockchain",required:!0,choices:e.map((function(r){return{value:r.value,label:r.label,sample:r.value,icon:r.icon||void 0}}))}]:[],"blockchain:call"===(null==(i=t.operation)?void 0:i.type)&&((null==(s=t.operation)?void 0:s.inputFields)||[]).filter((function(r){return"_grinderyContractAddress"===r.key})).length<1?[{key:"_grinderyContractAddress",type:"string",label:"Contract address",placeholder:"Enter contract address",required:!0}]:[],((null==(u=t.operation)?void 0:u.inputFields)||[]).filter((function(e){return"evmWallet"===r.key&&"_grinderyChain"!==e.key||"evmWallet"!==r.key})))})})})))||[]})},h=function(r){return a({},r,{triggers:r.triggers&&r.triggers.length>0?[].concat(r.triggers.filter((function(r){var e;return!(null!=(e=r.display)&&e.hidden)}))):void 0,actions:r.actions&&r.actions.length>0?[].concat(r.actions.filter((function(r){var e;return!(null!=(e=r.display)&&e.hidden)}))):void 0})};exports.default=function(){function r(){this.token=null,this.userId=null,this.workspaceId=null}var o=r.prototype;return o.authenticate=function(r){if(!r)throw new Error("Token required");this.token=r;var e=t(r);this.userId=e.sub||null,this.workspaceId=e.workspace||null},o.getToken=function(){if(!this.token)throw new Error("Authentication required");return this.token},o.createWorkflow=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workflow object is required");case 4:if(e.creator){r.next=6;break}throw new Error("Workflow creator is required");case 6:return r.next=8,s("or_createWorkflow",a({workflow:e},void 0!==t&&{workspaceKey:t}),this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.listWorkflows=function(){var r=i(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:return r.next=4,s("or_listWorkflows",a({},void 0!==e&&{workspaceKey:e}),this.token);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),o.updateWorkflow=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workflow key is required");case 4:if(t&&t.creator){r.next=6;break}throw new Error("Workflow creator is required");case 6:return r.next=8,s("or_updateWorkflow",{key:e,workflow:t},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.getWorkflowExecutions=function(){var r=i(n().mark((function r(e,t,o,i){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workflow key is required");case 4:return r.next=6,s("or_getWorkflowExecutions",a({workflowKey:e},void 0!==t&&{since:t},void 0!==o&&{until:o},void 0!==i&&{limit:i}),this.token);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r,this)})));return function(e,t,n,o){return r.apply(this,arguments)}}(),o.getWorkflowExecutionLog=function(){var r=i(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workflow execution ID is required");case 4:return r.next=6,s("or_getWorkflowExecutionLog",{executionId:e},this.token);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),o.isAllowedUser=function(){var r=i(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:return r.next=4,s("or_isAllowedUser",{app:e||void 0},this.token);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),o.testAction=function(){var r=i(n().mark((function r(e,t,o){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workflow step object is required");case 4:if(t){r.next=6;break}throw new Error("Sample input object is required");case 6:return r.next=8,s("or_testAction",{step:e,input:t,environment:o||"production"},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t,n){return r.apply(this,arguments)}}(),o.getConnectors=function(){var r=i(n().mark((function r(){var t,o,i,s,u,c,h;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=[],r.next=3,e.get("https://api.github.com/repos/grindery-io/grindery-nexus-schema-v2/contents/cds/web2");case 3:o=r.sent,i=0;case 5:if(!(i<o.data.length)){r.next=16;break}if(!(s=o.data[i].download_url)){r.next=13;break}return r.t0=t,r.next=11,e.get(s);case 11:r.t1=r.sent,r.t0.push.call(r.t0,r.t1);case 13:i++,r.next=5;break;case 16:return r.next=18,e.get("https://api.github.com/repos/grindery-io/grindery-nexus-schema-v2/contents/cds/web3");case 18:u=r.sent,c=0;case 20:if(!(c<u.data.length)){r.next=31;break}if(!(h=u.data[c].download_url)){r.next=28;break}return r.t2=t,r.next=26,e.get(h);case 26:r.t3=r.sent,r.t2.push.call(r.t2,r.t3);case 28:c++,r.next=20;break;case 31:return r.abrupt("return",t.filter((function(r){return r&&r.data})).map((function(r){return a({},r.data,{html_url:Array.isArray(u.data)&&u.data.find((function(e){return e.name&&e.name.includes(r.data.key)}))&&u.data.find((function(e){return e.name&&e.name.includes(r.data.key)})).html_url||Array.isArray(o.data)&&o.data.find((function(e){return e.name&&e.name.includes(r.data.key)}))&&o.data.find((function(e){return e.name&&e.name.includes(r.data.key)})).html_url||""})})));case 32:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),o.deleteWorkflow=function(){var r=i(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workflow key is required");case 4:return r.next=6,s("or_deleteWorkflow",{key:e},this.token);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),o.requestEarlyAccess=function(){var r=i(n().mark((function r(e,t,o){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Email is required");case 4:if(/^[^\s@]+@([^\s@.,]+\.)+[^\s@.,]{2,}$/.test(e)){r.next=6;break}throw new Error("Invalid email");case 6:return r.next=8,s("or_requestEarlyAccess",{email:e,source:t||"",app:o||""},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t,n){return r.apply(this,arguments)}}(),o.saveWalletAddress=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Wallet address is required");case 4:if(!t||/^[^\s@]+@([^\s@.,]+\.)+[^\s@.,]{2,}$/.test(t)){r.next=6;break}throw new Error("Invalid email");case 6:return r.next=8,s("or_saveWalletAddress",{email:t,walletAddress:e},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.callInputProvider=function(){var r=i(n().mark((function r(e,t,o,i){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Connector key is required");case 4:if(t){r.next=6;break}throw new Error("Operation key is required");case 6:if(o){r.next=8;break}throw new Error("JSON RPC request object is required");case 8:if(o.method&&"grinderyNexusConnectorUpdateFields"===o.method){r.next=10;break}throw new Error('JSON RPC request object must have "method" property with value "grinderyNexusConnectorUpdateFields"');case 10:if(o.jsonrpc&&"2.0"===o.jsonrpc){r.next=12;break}throw new Error("JSON RPC request object must have 2.0 version");case 12:if(o.params&&o.params.key){r.next=14;break}throw new Error('JSON RPC request object must have "params" property with operation key specified');case 14:if(o.params.key===t){r.next=16;break}throw new Error('JSON RPC request object params "key" property must be equal to operationKey');case 16:return r.next=18,u("POST","/input-provider/"+e+"/"+t+(i?"?_grinderyEnvironment="+i:""),o,this.token);case 18:return r.abrupt("return",r.sent);case 19:case"end":return r.stop()}}),r,this)})));return function(e,t,n,o){return r.apply(this,arguments)}}(),o.callWebhook=function(){var r=i(n().mark((function r(e,t,o,i){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}throw new Error("Connector key is required");case 2:if(t){r.next=4;break}throw new Error("Operation key is required");case 4:if(o){r.next=6;break}throw new Error("Body object is required");case 6:return r.next=8,u("POST","/webhook/"+e+"/"+t+(i?"?_grinderyEnvironment="+i:""),o);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r)})));return function(e,t,n,o){return r.apply(this,arguments)}}(),o.listDrivers=function(){var r=i(n().mark((function r(t){var o,i,s,u=this;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o="https://cds.grindery.org/_index.json",t&&"staging"===t&&(o="https://cds-staging.grindery.org/_index.json"),r.next=4,e.get(o).catch((function(){return null}));case 4:if(!(i=r.sent)||!i.data){r.next=10;break}return s=Object.keys(i.data).map((function(r){return h(a({},i.data[r]))})).filter((function(r){var e,t,n,o,i;return r&&(!r.access||"public"===(null==(e=r.access)?void 0:e.toLowerCase())||u.userId&&"private"===(null==(t=r.access)?void 0:t.toLowerCase())&&(null==(n=r.user)?void 0:n.toLowerCase())===u.userId.toLowerCase()||u.workspaceId&&"workspace"===(null==(o=r.access)?void 0:o.toLowerCase())&&(null==(i=r.workspace)?void 0:i.toLowerCase())===u.workspaceId.toLowerCase())})),r.abrupt("return",s);case 10:return r.abrupt("return",[]);case 11:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),o.getDriver=function(){var r=i(n().mark((function r(t,o,i){var a,s,u;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===i&&(i=!0),t){r.next=3;break}throw new Error("Driver key required");case 3:return a="https://cds.grindery.org/"+t+".json",o&&"staging"===o&&(a="https://cds-staging.grindery.org/"+t+".json"),r.next=7,e.get(a).catch((function(){return null}));case 7:if(!(s=r.sent)||!s.data){r.next=19;break}if(!i){r.next=16;break}return r.next=12,this.listChains("evm",o||"production");case 12:return u=r.sent,r.abrupt("return",c(h(s.data),u||[]));case 16:return r.abrupt("return",h(s.data));case 17:r.next=20;break;case 19:return r.abrupt("return",null);case 20:case"end":return r.stop()}}),r,this)})));return function(e,t,n){return r.apply(this,arguments)}}(),o.listWorkspaces=function(){var r=i(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:return r.next=4,s("or_listWorkspaces",{},this.token);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}(),o.createWorkspace=function(){var r=i(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e.title){r.next=4;break}throw new Error("Workspace title is required");case 4:return r.next=6,s("or_createWorkspace",e,this.token);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),o.updateWorkspace=function(){var r=i(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e.key){r.next=4;break}throw new Error("Workspace key is required");case 4:if(!e.admins||Array.isArray(e.admins)){r.next=6;break}throw new Error("Admins must be an array");case 6:if(!e.users||Array.isArray(e.users)){r.next=8;break}throw new Error("Users must be an array");case 8:return r.next=10,s("or_updateWorkspace",e,this.token);case 10:return r.abrupt("return",r.sent);case 11:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),o.leaveWorkspace=function(){var r=i(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workspace key is required");case 4:return r.next=6,s("or_leaveWorkspace",{key:e},this.token);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),o.deleteWorkspace=function(){var r=i(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workspace key is required");case 4:return r.next=6,s("or_deleteWorkspace",{key:e},this.token);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),o.moveWorkflowToWorkspace=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workflow key is required");case 4:return r.next=6,s("or_moveWorkflowToWorkspace",{key:e,newWorkspaceKey:t},this.token);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.addUserToWorkspace=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workspace key is required");case 4:if(t){r.next=6;break}throw new Error("User ID is required");case 6:return r.next=8,s("or_workspaceAddUser",{key:e,accountId:t},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.removeUserFromWorkspace=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workspace key is required");case 4:if(t){r.next=6;break}throw new Error("User ID is required");case 6:return r.next=8,s("or_workspaceRemoveUser",{key:e,accountId:t},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.addAdminToWorkspace=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workspace key is required");case 4:if(t){r.next=6;break}throw new Error("User ID is required");case 6:return r.next=8,s("or_workspaceAddAdmin",{key:e,accountId:t},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.removeAdminFromWorkspace=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workspace key is required");case 4:if(t){r.next=6;break}throw new Error("User ID is required");case 6:return r.next=8,s("or_workspaceRemoveAdmin",{key:e,accountId:t},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.listAuthCredentials=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Connector ID is required");case 4:if(t){r.next=6;break}throw new Error("Environment is required");case 6:return r.next=8,s("or_listAuthCredentials",{connectorId:e,environment:t},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.updateAuthCredentials=function(){var r=i(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Credential key is required");case 4:if(t){r.next=6;break}throw new Error("Display name is required");case 6:return r.next=8,s("or_updateAuthCredentials",{key:e,displayName:t},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.putConnectorSecrets=function(){var r=i(n().mark((function r(e,t,o){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Connector ID is required");case 4:if(t){r.next=6;break}throw new Error("Secrets object is required");case 6:if(o){r.next=8;break}throw new Error("Environment is required");case 8:return r.next=10,s("or_putConnectorSecrets",{connectorId:e,secrets:t,environment:o},this.token);case 10:return r.abrupt("return",r.sent);case 11:case"end":return r.stop()}}),r,this)})));return function(e,t,n){return r.apply(this,arguments)}}(),o.saveNotificationsState=function(){var r=i(n().mark((function r(e,t){var o;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Notifications state is required");case 4:return o={state:e},t&&(o.notificationToken=t),r.next=8,s("or_saveNotificationsState",o,this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t){return r.apply(this,arguments)}}(),o.runAction=function(){var r=i(n().mark((function r(e,t,o){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Workflow step object is required");case 4:if(t){r.next=6;break}throw new Error("Sample input object is required");case 6:return r.next=8,s("or_runAction",{step:e,input:t,environment:o||"production"},this.token);case 8:return r.abrupt("return",r.sent);case 9:case"end":return r.stop()}}),r,this)})));return function(e,t,n){return r.apply(this,arguments)}}(),o.listChains=function(){var r=i(n().mark((function r(t,o){var i,a,s;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return void 0===t&&(t="all"),i="https://cds.grindery.org/chains",o&&"staging"===o&&(i="https://cds-staging.grindery.org/chains"),a=i,"all"===t&&(a=i+"/_index.json"),"evm"===t&&(a=i+"/evm.json"),"non-evm"===t&&(a=i+"/non-evm.json"),r.next=9,e.get(a).catch((function(){return null}));case 9:return r.abrupt("return",(s=r.sent)&&s.data||[]);case 11:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),o.getUser=function(){if(!this.token||!this.userId)return null;var r=this.userId,e=r.split(":")[2],t=e.substring(0,6)+"..."+e.substring(e.length-4);return{id:r,address:e,address_short:t,workspace:this.workspaceId||null}},o.isUserHasEmail=function(){var r=i(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:return r.next=4,s("or_isUserHasEmail",{},this.token);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}(),o.updateUserEmail=function(){var r=i(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:if(e){r.next=4;break}throw new Error("Email is required");case 4:return r.next=6,s("or_updateUserEmail",{email:e},this.token);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),o.deleteUser=function(){var r=i(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:return r.next=4,s("or_deleteUser",{},this.token);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}(),o.getUserEmail=function(){var r=i(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.token){r.next=2;break}throw new Error("Authentication required");case 2:return r.next=4,s("or_getUserEmail",{},this.token);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}(),r}();
//# sourceMappingURL=grindery-nexus-client.cjs.production.min.js.map
